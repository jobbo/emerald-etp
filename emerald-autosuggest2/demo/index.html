<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>emerald-autosuggest</title>
    <script src="../../webcomponentsjs/webcomponents-lite.min.js"></script>
    <link rel="import" href="../../jet-app/jet-app.html">
    <link rel="import" href="../../coral-popup-panel/coral-popup-panel.html">
    <link rel="import" href="../../coral-list/coral-list.html">
    <link rel="import" href="../../coral-list/coral-list-item.html">
    <link rel="import" href="../emerald-autosuggest.html">
    <link rel="import" href="../../uifr-core-style/resources/demo/demo.html">
    
    <style>
      textarea {
        color: #c2c2c2;
        background-color: #000;
        border: 1px solid #3c3c42;
        font-family: inherit;
        font-size: 13px;
        padding: 5px;

        width: 400px;
        height: 300px;
      }

      body[theme="pearl"] textarea {
        color: #505050;
        background-color: #fff;
        border-color: #A9AFBA;
      }

    </style>
  </head>
  <body is="uifr-app" unresolved>
    
    <jet-app appid="emerald-autosuggest-demo" apptitle="emerald-autosuggest"></jet-app>
    
    <demo-region layout="column">
      
      <!-- DEFAULT -->
      <demo-block spacing>
        <demo-block-header>DEFAULT</demo-block-header>
        <input type="text" id="searchDefault" placeholder="Search or Enter a Command" size="50">
        <emerald-autosuggest id="default"></emerald-autosuggest>
        <script>
          window.addEventListener('WebComponentsReady', function (e) {
            var searchInput = document.getElementById('searchDefault');
            var autoSuggest = document.getElementById('default');
            autoSuggest.setInput(searchInput);
          });
        </script>
      </demo-block>

      <!-- EVENTS -->
      <demo-block spacing>
        <demo-block-header>EVENTS</demo-block-header>
        Event: <span id="eventSpan">...</span>
        <br><br>

        <input type="text" id="searchEvents" placeholder="Search or Enter a Command" size="50">
        <emerald-autosuggest id="events"></emerald-autosuggest>
        <script>
          window.addEventListener('WebComponentsReady', function (e) {
            var itemValue;
            var span = document.getElementById('eventSpan');
            var searchInput = document.getElementById('searchEvents');
            var autoSuggest = document.getElementById('events');
            autoSuggest.setInput(searchInput);

            autoSuggest.addEventListener('item-select', function (e) {
              itemValue = e.detail.item.value;
              span.innerHTML = '"item-select" event is fired. "' + itemValue.title + ' (' + itemValue.cmd + ')' + '" is selected';
            });

            autoSuggest.addEventListener('item-highlight', function (e) {
              itemValue = e.detail.item.value;
              span.innerHTML = '"item-highlight" event is fired. "' + itemValue.title + ' (' + itemValue.cmd + ')' + '" is highlighted';
            });

            autoSuggest.addEventListener('more-search', function (e) {
              span.innerHTML = '"more-search" event is fired. More search URL for keyword "' + e.detail.keyword + '" is "' + e.detail.url + '"';
            });
          });
        </script>
      </demo-block>

      <!-- SUGGESTION ITEM'S DATA -->
      <demo-block spacing>
        <demo-block-header>SUGGESTION ITEM'S DATA</demo-block-header>
        Please enter a keyword and select at any suggestion item.
        <br><br>

        <input type="text" id="searchItemData" placeholder="Search or Enter a Command" size="50">
        <emerald-autosuggest id="itemData"></emerald-autosuggest>
        <br><br>

        Item's properties.
        <br>

        <textarea id="propertiesTextarea"></textarea>
        <script>
          window.addEventListener('WebComponentsReady', function (e) {
            var searchInput = document.getElementById('searchItemData');
            var autoSuggest = document.getElementById('itemData');
            autoSuggest.setInput(searchInput);

            var showSuggestionData = function (e) {
              var textarea = document.getElementById('propertiesTextarea');
              textarea.value = JSON.stringify(e.detail.item.value, null, 2);
            };

            autoSuggest.addEventListener('item-select', showSuggestionData);
          });
        </script>
      </demo-block>

      <!-- CUSTOM PROFILE -->
      <demo-block spacing>
        <demo-block-header>CUSTOM PROFILE</demo-block-header>
        <input type="text" id="searchCustomProfile" placeholder="Search or Enter a Command" size="50">
        <emerald-autosuggest id="customProfile" profile="Chart"></emerald-autosuggest>
        <br><br>

        <script>
          window.addEventListener('WebComponentsReady', function (e) {
            var searchInput = document.getElementById('searchCustomProfile');
            var autoSuggest = document.getElementById('customProfile');
            autoSuggest.setInput(searchInput);
          });
        </script>
      </demo-block>

      <!-- FIELD MAPPING -->
      <demo-block spacing>
        <demo-block-header>FIELD MAPPING</demo-block-header>
        <input type="text" id="searchFieldMapping" placeholder="Search or Enter a Command" size="50">
        <emerald-autosuggest id="fieldMapping"></emerald-autosuggest>
        <br><br>

        <script>
          window.addEventListener('WebComponentsReady', function (e) {
            var searchInput = document.getElementById('searchFieldMapping');
            var autoSuggest = document.getElementById('fieldMapping');
            autoSuggest.fieldMapping = { symbol: 'p/OAPermID' };
            autoSuggest.setInput(searchInput);
          });
        </script>
      </demo-block>

      <!-- CUSTOM MORE SEARCH -->
      <demo-block spacing>
        <demo-block-header>CUSTOM MORE SEARCH</demo-block-header>
        <input type="text" id="searchCustomMoreSearch" placeholder="Search or Enter a Command" size="50">
        <emerald-autosuggest id="customMoreSearch" more-search-text='See more results for "{0}"'></emerald-autosuggest>
        <br><br>

        <script>
          window.addEventListener('WebComponentsReady', function (e) {
            var searchInput = document.getElementById('searchCustomMoreSearch');
            var autoSuggest = document.getElementById('customMoreSearch');
            autoSuggest.setInput(searchInput);
          });
        </script>
      </demo-block>

      <!-- DISABLE MORE SEARCH -->
      <demo-block spacing>
        <demo-block-header>DISABLE MORE SEARCH</demo-block-header>
        <input type="text" id="searchMoreSearchDisabled" placeholder="Search or Enter a Command" size="50">
        <emerald-autosuggest id="moreSearchDisabled" more-search-disabled></emerald-autosuggest>
        <br><br>

        <script>
          window.addEventListener('WebComponentsReady', function (e) {
            var searchInput = document.getElementById('searchMoreSearchDisabled');
            var autoSuggest = document.getElementById('moreSearchDisabled');
            autoSuggest.setInput(searchInput);
          });
        </script>
      </demo-block>

      <!-- DISABLE AUTO-SELECT -->
      <demo-block spacing>
        <demo-block-header>DISABLE AUTO-SELECT</demo-block-header>
        <input type="text" id="searchAutoSelectDisabled" placeholder="Search or Enter a Command" size="50">
        <emerald-autosuggest id="autoSelectDisabled" auto-select-disabled></emerald-autosuggest>
        <br><br>

        <script>
          window.addEventListener('WebComponentsReady', function (e) {
            var searchInput = document.getElementById('searchAutoSelectDisabled');
            var autoSuggest = document.getElementById('autoSelectDisabled');
            autoSuggest.setInput(searchInput);
          });
        </script>
      </demo-block>

      <!-- USE DATA TRANSFORMER -->
      <demo-block spacing>
        <demo-block-header>USE DATA TRANSFORMER</demo-block-header>
        Suggestion data is modified by data transformer.
        The first suggestion is manually added.
        <br><br>

        <input type="text" id="searchTransformer" placeholder="Search or Enter a Command" size="50">
        <emerald-autosuggest id="transformer" profile="Field Selector"></emerald-autosuggest>
        <script>
          window.addEventListener('WebComponentsReady', function (e) {
            var searchInput = document.getElementById('searchTransformer');
            var autoSuggest = document.getElementById('transformer');
            autoSuggest.setTransformer(function (data) {
              data.suggestions.unshift({
                'label': 'My Price Field',
                'value': {
                  'symbol': 'My.Price.Close',
                  'title': 'My <b>Price</b>',
                  'vc': 'AC'
                },
                'highlighted': false
              });

              return data;
            });
            autoSuggest.setInput(searchInput);
          });
        </script>
      </demo-block>
    </demo-region>
    
    <script>
      var elementList = document.querySelectorAll('emerald-autosuggest');

      window.addEventListener('scroll', function () {
        var i;
        var el;

        for (i = 0; i < elementList.length; i++) {
          el = elementList[i];
          el.hideSuggestions();
        }
      }, true);
    </script>
  </body>
</html>
